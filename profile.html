<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil korisnika</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

   <style>
input,
textarea {
    touch-action: manipulation; /* Omogućava manipulaciju bez zumiranja */
    
}


      


/* User info styling */












/* Main container for all products */
.marketplace-outline {
    padding: 20px;
    border: 2px solid #ccc; /* Outer border for the entire marketplace */
    background-color: #fff; /* White background */
    border-radius: 10px;
    max-width: 1200px;
    margin: 0 auto; /* Center the container */
}

/* Container for individual products */
.product {
        border: 5px solid; /* Postavite debljinu obruba */
        border-image: linear-gradient(to right, #5a99cd, #4b0078) 1; /* Gradijentni obrub s lijeva na desno */
        border-radius: 8px; /* Zaobljeni uglovi */
        padding: 10px; /* Unutarnji razmak */
        margin: 10px; /* Vanjski razmak između proizvoda */
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* Blaga sjena za bolji izgled */
    }

    .product img {
        width: 200px;
        height: 200px;
        object-fit: cover;
        margin-bottom: 10px;
        border-radius: 8px;
    }

    .product-list-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px; /* Razmak između proizvoda */
        justify-content: center; /* Centriranje proizvoda */
    }

/* Individual product box */
.product-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 200px; /* Set fixed width */
    height: 300px; /* Set fixed height */
    padding: 10px;
    background-color: #f9f9f9; /* Light background for products */
    border: 1px solid #ccc; /* Border for each product */
    border-radius: 8px;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
}

/* Image styling for each product */
.product-box img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 5px;
    margin-bottom: 10px;
}

/* Product name styling */
.product-name {
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 5px;
}

/* Product price styling */
.product-price {
    font-size: 14px;
    color: #333;
    margin-bottom: 10px;
}

/* 'Kupi' button styling */
.buy-button {
    width: 100%;
    padding: 8px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.buy-button:hover {
    background-color: #45a049;
}

.marketplace-outline h2 {
        text-align: center; /* Centrira tekst naslova */
        margin-bottom: 20px; /* Dodaje razmak ispod naslova */
        font-weight: bold; /* Podebljava naslov */
    }

        /* Stilovi za profilnu stranicu */
        .profile-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }






       .profile-outline {
            padding: 20px;
            border: 2px solid #ccc; /* Outer border for the entire profile */
            background-color: #fff; /* White background */
            border-radius: 10px;
            max-width: 1200px;
            margin: 0 auto; /* Center the container */
        }

        /* Title styling within the large outline box */
        .profile-title {
    font-size: 24px; /* Vraćen originalni font za bolju vidljivost */
    padding: 10px;
    color: #fff;
    background-color: #4b0078;
    border-radius: 8px;
    text-align: center;
    margin: 0 auto 20px auto; /* Centriranje naslova */
    max-width: 400px; /* Smanjena maksimalna širina */
}

@media screen and (max-width: 768px) {
    .profile-title {
        max-width: 280px; /* Smanjena maksimalna širina za tablete i manje ekrane */
    }
}

        /* Container for individual products */
        .product {
            border: 5px solid;
            border-image: linear-gradient(to right, #5a99cd, #4b0078) 1;
            border-radius: 8px;
            padding: 10px;
            margin: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        }

        .product img {
    width: 250px; /* Povećana širina slike */
    height: 250px; /* Povećana visina slike */
    object-fit: cover;
    margin-bottom: 10px;
    border-radius: 8px;
}


        .product-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
            text-align: center;
        }

        .product-price {
            font-size: 14px;
            color: #333;
            margin-bottom: 10px;
        }

        .buy-button, .set-price-button {
            padding: 8px;
            margin-top: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .buy-button {
            background-color: #4CAF50;
            color: white;
        }

        .set-price-button {
            background-color: #4b0078;
            color: white;
        }

        .input-price {
            width: 100px;
            padding: 5px;
            margin-top: 10px;
            text-align: center;
        }

        .product-list-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        #current-price-display {
    font-weight: bold; /* Podebljava sav tekst unutar div-a */
    padding-left: 40px;
}

    </style>
</head>
<body>

    <header class="header-container">
        <div id="greeting">Pozdrav, <span id="logged-in-user"></span></div>
        <div id="current-price-display">Your wallet: <span id="current-price">0.00</span> <span class="delta">&#948;</span></div>
        
        <!-- Toggle button for mobile devices -->
        <button id="toggle-menu-button" class="toggle-button">☰</button>
        
        <!-- Desktop menu -->
        <nav id="desktop-menu">
            <a href="#"><span class="material-icons">home</span> Home</a>
            <a href="#"><span class="material-icons">group</span> Team</a>
            <a href="#" id="chat-link"><span class="material-icons">chat</span> Chat</a>
            <a href="#"><span class="material-icons">person</span> Profile</a>
        </nav>


        <nav id="toggle-menu">
            <a href="#"><span class="material-icons">home</span> Home</a>
            <a href="#"><span class="material-icons">group</span> Team</a>
            <a href="#" id="chat-link"><span class="material-icons">chat</span> Chat</a>
            <a href="#"><span class="material-icons">person</span> Profile</a>
        </nav>
    </header>
  

</script>


    
    <script>
        const toggleMenuButton = document.getElementById('toggle-menu-button');
        const toggleMenu = document.getElementById('toggle-menu');

        toggleMenuButton.addEventListener('click', () => {
            // Togglovanje prikaza menija
            if (toggleMenu.style.display === 'flex') {
                toggleMenu.style.display = 'none'; // Sakrij meni
            } else {
                toggleMenu.style.display = 'flex'; // Prikaži meni
            }
        });
    </script>

   


    
    <div class="image-container">
        <img src="images/delta.png" alt="Delta Image" style="max-width: 100%; height: auto;">
    </div>

    









    <div class="partnership-box">
        <p>
            Delta coin is selecting partnerships with crypto-services and general businesses ahead of our Open Network launch. 
            This is a unique, early opportunity for businesses to connect with over 10 million engaged Delta coin fans and become part of Delta’s rapidly expanding Web3 ecosystem. 
            If your company is interested in partnering with Delta or you’d like to introduce a business to partner with Delta, tap “Partnerships” to explore how and why.
        </p>
    </div>

   

    <div class="background blue"></div>
    <div class="background purple"></div>




//kupljeni//
<div class="profile-outline">
    <div id="profile-title" class="profile-title"></div>
    <div id="profile-products" class="product-list-container"></div>
</div>




    <script type="module">
       import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getFirestore, collection, getDocs, query, where, doc, getDoc, updateDoc, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBKfTE0qZdxVLq0lvmli367_yyqpGK-fPA",
            authDomain: "piii-7844e.firebaseapp.com",
            projectId: "piii-7844e",
            storageBucket: "piii-7844e.appspot.com",
            messagingSenderId: "315770496799",
            appId: "1:315770496799:web:0197d4baf2c8731d88722a",
            measurementId: "G-JH9SDWTS9V"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);



        

        

        // Dohvati parametre iz URL-a
        const params = new URLSearchParams(window.location.search);
        const profileName = params.get('ime');
        const loggedInUser = params.get('loggedInUser');
        let currentPrice = parseFloat(params.get('trenutnaCijena'));

        let loggedInUserIme = ''; // Varijabla za pravo ime prijavljenog korisnika
        let loggedInUserId = ''; // Varijabla za ID prijavljenog korisnika u Firestore-u

        // Funkcija za dobijanje 'ime' korisnika na osnovu 'username'
        async function getLoggedInUserIme() {
            const userCollection = collection(db, 'network');
            const q = query(userCollection, where('username', '==', loggedInUser));
            const querySnapshot = await getDocs(q);

            if (!querySnapshot.empty) {
                querySnapshot.forEach(docSnap => {
                    const userData = docSnap.data();
                    loggedInUserIme = userData.ime;
                    loggedInUserId = docSnap.id;
                });
            } else {
                console.error("Korisnik ne postoji u Firestore-u.");
            }
        }

        // Pozovi funkciju za dobijanje 'ime' korisnika
        await getLoggedInUserIme();

        // Prikaži ime prijavljenog korisnika i trenutnu cijenu
        document.getElementById('logged-in-user').innerText = loggedInUserIme;
        document.getElementById('current-price').innerText = currentPrice.toFixed(2);

        // Prikaži naslov profila
        const profileTitle = document.getElementById('profile-title');
        profileTitle.innerText = loggedInUserIme === profileName ? 'Vaš profil' : `Profil korisnika: ${profileName}`;

        // Učitaj proizvode korisnika
       // Funkcija za učitavanje proizvoda na profilu
async function loadProfileProducts() {
    const productCollection = collection(db, 'products');
    const querySnapshot = await getDocs(productCollection);
    const profileProducts = document.getElementById('profile-products');
    profileProducts.innerHTML = '';

    querySnapshot.forEach(docSnap => {
        const productData = docSnap.data();

        if (productData.ownerName === profileName) {
            const productDiv = document.createElement('div');
            productDiv.classList.add('product');

            const productImg = document.createElement('img');
            productImg.src = productData.imageUrl;
            productDiv.appendChild(productImg);

            const productName = document.createElement('div');
            productName.classList.add('product-name');
            productName.innerText = productData.name;
            productDiv.appendChild(productName);

            const productPrice = document.createElement('div');
            productPrice.classList.add('product-price');
            productPrice.innerText = `Cijena: ${productData.price} Delta coin`;
            productDiv.appendChild(productPrice);

            // Dodavanje cijene u ETH ako postoji
            if (productData.cryptoPrice) {
                const productCryptoPrice = document.createElement('div');
                productCryptoPrice.classList.add('product-price');
                productCryptoPrice.innerText = `Cijena u ETH: ${productData.cryptoPrice} ETH`;
                productDiv.appendChild(productCryptoPrice);
            }

            if (profileName === loggedInUserIme) {
                // Dodaj opcije za postavljanje cijene
                const priceInput = document.createElement('input');
                priceInput.type = 'number';
                priceInput.placeholder = 'Nova cijena (Delta coin)';
                priceInput.classList.add('input-price');

                const cryptoPriceInput = document.createElement('input');
                cryptoPriceInput.type = 'number';
                cryptoPriceInput.placeholder = 'Nova cijena (ETH)';
                cryptoPriceInput.classList.add('input-price');

                const setPriceButton = document.createElement('button');
                setPriceButton.innerText = 'Postavi cijene';
                setPriceButton.classList.add('set-price-button');
                setPriceButton.addEventListener('click', async () => {
                    const novaCijena = parseFloat(priceInput.value);
                    const novaCryptoCijena = parseFloat(cryptoPriceInput.value);

                    if ((!isNaN(novaCijena) && novaCijena > 0) || (!isNaN(novaCryptoCijena) && novaCryptoCijena > 0)) {
                        const updateData = {};
                        if (!isNaN(novaCijena) && novaCijena > 0) {
                            updateData.price = novaCijena;
                        }
                        if (!isNaN(novaCryptoCijena) && novaCryptoCijena > 0) {
                            updateData.cryptoPrice = novaCryptoCijena;
                        }
                        await updateDoc(doc(db, 'products', docSnap.id), updateData);
                        alert('Nove cijene postavljene!');
                        loadProfileProducts(); // Osvježi prikaz
                    } else {
                        alert('Unesite ispravne cijene!');
                    }
                });

                productDiv.appendChild(priceInput);
                productDiv.appendChild(cryptoPriceInput);
                productDiv.appendChild(setPriceButton);
            } else {
                // Dodaj dugme za kupovinu Delta coinom
                const buyButton = document.createElement('button');
                buyButton.innerText = 'Kupi (Delta coin)';
                buyButton.classList.add('buy-button');
                buyButton.addEventListener('click', async () => {
                    if (currentPrice >= productData.price) {
                        await updateProductOwnership(docSnap.id, productData);
                    } else {
                        alert('Nemate dovoljno sredstava!');
                    }
                });
                productDiv.appendChild(buyButton);

                // Dodaj dugme za kupovinu putem kriptovalute
                const buyWithCryptoButton = document.createElement('button');
                buyWithCryptoButton.innerText = 'Kupi (ETH)';
                buyWithCryptoButton.classList.add('buy-button');
                buyWithCryptoButton.style.backgroundColor = 'purple';
                buyWithCryptoButton.addEventListener('click', async () => {
                    await handleCryptoPurchase(docSnap.id, productData);
                });
                productDiv.appendChild(buyWithCryptoButton);
            }

            profileProducts.appendChild(productDiv);
        }
    });
}

// Funkcija za rukovanje kripto kupovinom
async function handleCryptoPurchase(productId, productData) {
    if (typeof window.ethereum !== 'undefined') {
        try {
            await window.ethereum.request({ method: 'eth_requestAccounts' });
            const web3 = new Web3(window.ethereum);

            const accounts = await web3.eth.getAccounts();
            const account = accounts[0];

            const ethPrice = productData.cryptoPrice;
            const weiValue = web3.utils.toWei(ethPrice.toString(), 'ether');

            const txParams = {
                from: account,
                to: '0x045cd928A66C6FAb414c807005CFD7769470FDAf',
                value: weiValue,
                gas: 21000
            };

            const transactionHash = await web3.eth.sendTransaction(txParams);

            // Ažuriranje vlasništva proizvoda u Firestore-u
            await updateDoc(doc(db, 'products', productId), {
                owner: loggedInUserId,
                ownerName: loggedInUserIme,
                sold: true
            });

            alert(`Uspješna uplata! Transakcija: ${transactionHash.transactionHash}`);
            loadProfileProducts(); // Osvježi prikaz
        } catch (error) {
            console.error('Greška prilikom MetaMask transakcije:', error);
            alert('Došlo je do greške. Pokušajte ponovo.');
        }
    } else {
        alert('Molimo vas da instalirate MetaMask ekstenziju za korištenje kripto plaćanja.');
    }
}

// Pozovi funkciju za učitavanje proizvoda
loadProfileProducts();

    </script>













<style>
    body {
        font-family: 'Roboto', sans-serif; /* Promjena fonta */
        margin: 0;
        padding: 0;
        background-color: black;
        
       
    }
   

    @media (max-width: 768px) {
    html, body {
        width: 100%;
        overflow-x: hidden; /* Onemogućava horizontalno pomjeranje */
        margin: 0; /* Uklanja podrazumijevane margine */
        padding: 0; /* Uklanja podrazumijevane paddinge */
    }

    /* Osiguraj da svi kontejneri i elementi imaju odgovarajuću širinu */
    * {
        max-width: 100%; /* Ograničava širinu na 100% */
        box-sizing: border-box; /* Uključuje padding i border u ukupnu širinu */
    }

    img {
        max-width: 100%; /* Održava slike unutar širine kontejnera */
        height: auto; /* Održava odnos slike */
    }

    /* Podesi širinu specifičnih elemenata ako je potrebno */
    .some-element { /* Zameniti sa stvarnim klasama */
        width: 100%; /* Ili odgovarajući procenat */
    }
}

    .background {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .blue {
    background: linear-gradient(to bottom right, rgba(23, 135, 226, 0.6), rgba(0, 0, 0, 0) 50%);
    position: absolute;
    top: 0;
    left: 0;
    width: 50%;
    height: 50%;
    
}


.purple {
    background: linear-gradient(to top left, rgba(128, 0, 128, 0.6), rgba(0, 0, 0, 0) 50%);
    position: fixed; /* Changed to fixed to always stick to the bottom-right */
    bottom: 0;
    right: 0;
    width: 50%;
    height: 50%;
    z-index: 1; /* Make sure it stays below other content if necessary */
}



        
    nav {
        display: flex;
        gap: 20px;
    }
    nav a {
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
    }
    nav .material-icons {
        margin-right: 5px; /* Razmak između ikone i teksta */
    }
    .container {
        display: flex;
        
        padding: 20px;
    }
    .icon-section {
    flex: 2;
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 20px;
}

.icon {
    background-color: transparent; /* Prozirna pozadina */
    border-radius: 0; /* Pravougaoni oblik */
    display: flex;
    justify-content: center;
    align-items: center;
    width: 120px; /* Širina pravougaonika */
    height: 60px; /* Visina pravougaonika */
    font-size: 24px;
    cursor: pointer;
    position: relative;
    background: transparent; /* Prozirna pozadina */
    color: white; /* Bijela boja teksta */
    border: 2px solid transparent; /* Prozirni obrub (outline) */
    border-image: linear-gradient(to right, #5a99cd, #4b0078) 1; /* Gradijentni obrub s lijeva na desno */


    

    
}

   
    .amount {
        font-size: 24px;
        margin-left: 2px;
    }


/* Stil za ikonice */
.material-icons {
    vertical-align: middle; /* Poravnanje ikone sa tekstom */
    margin-right: 8px; /* Razmak između ikone i teksta */
}


#share-icon {
    background-color: transparent; /* Prozirna pozadina */
    border-radius: 0; /* Pravougaoni oblik */
    display: flex;
    justify-content: center;
    align-items: center;
    width: 150px; /* Širina pravougaonika */
    height: 60px; /* Visina pravougaonika */
    font-size: 22px;
    cursor: pointer;
    position: relative;
    background: transparent; /* Prozirna pozadina */
    color: white; /* Bijela boja teksta */
    border: 2px solid transparent; /* Prozirni obrub (outline) */
    border-image: linear-gradient(to right, #5a99cd, #4b0078) 1; /* Gradijentni obrub s lijeva na desno */


}

#share-icon span.material-icons {
    font-size: 24px; /* Veličina ikone */
}


</style>




<style>
    .partnership-box {
        border-width: 2px; /* debljina obruba */
        border-style: solid; /* stil obruba */
        border-image: linear-gradient(to right, #5a99cd, #4b0078) 1; /* gradijentni obrub s lijeva na desno */
        padding: 20px; /* razmak unutar boxa */
        margin: 20px auto; /* razmak iznad i ispod boxa, centrirano */
        max-width: 600px; /* maksimalna širina boxa */
        text-align: justify; /* opravdanje teksta */
        background-color: #000; /* crna pozadina */
        color: #fff; /* bijela boja teksta */
        border-radius: 50px !important; /* povećanje zaobljenosti ivica */
    }

    .partnership-box p {
        margin: 0; /* uklanja zadani razmak oko paragrafa */
        text-indent: 0; /* nema uvlačenja prve linije */
        line-height: 1.6; /* povećava razmak između redova */
    }

    .partnership-box img {
    width: 100%; /* Postavi osnovnu širinu na 100% da se prilagođava */
    max-width: 600px; /* Maksimalna širina za desktop */
    height: auto; /* Automatsko prilagođavanje visine */
}

/* Za mobilne uređaje */
@media only screen and (max-width: 768px) {
    .partnership-box img {
        max-width: 350px; /* Maksimalna širina za mobitele */
    }
}

</style>




<style>
   header {

  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  position: relative; /* Omogućuje apsolutno pozicioniranje menija */
}


/* Toggle dugme */
.toggle-button {
  display: none; /* Skriveno po defaultu */
  font-size: 30px;
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  margin-left: auto;
}

#toggle-menu {
  display: none; /* Skriveno po defaultu */
  flex-direction: column; /* Vertikalno poravnanje menija */
  background: linear-gradient(to bottom, #000000, #4b0078); /* Gradijent od plave do tamno ljubičaste */
  position: absolute;
  right: 0px;
  top: 60px;
  width: 50%;
  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 100;
}





#toggle-menu a {
  color: white;
  text-decoration: none;
  padding: 10px 20px;
  display: block;
  text-align: center;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

/* Stil za desktop meni */
#desktop-menu {
  display: flex;
}

#desktop-menu a {
  margin-left: 20px;
  text-decoration: none;
  color: white;
}

/* Media query za mobilne uređaje */
@media (max-width: 768px) {
  /* Prikaži toggle dugme na mobilnim uređajima */
  .toggle-button {
      display: block;
      transform: translateX(20px); /* Pomjera udesno za 20px */
  }
  /* Sakrij desktop meni na mobilnim uređajima */
  #desktop-menu {
      display: none;
  }

}

.image-container {
    display: flex;
    justify-content: center; /* Centriraj sliku */
    align-items: flex-start; /* Poravnaj gornji dio */
    position: relative;
}

@media (max-width: 768px) {
    .image-container {
        align-items: flex-start; /* Gornji dio */
        transform: translateY(10px); /* Pomakni prema dolje na mobilnim uređajima */
    }
}

.image-container img {
    animation: pulse 3s infinite; /* Animacija nazvana 'pulse' koja traje 2 sekunde i ponavlja se beskonačno */
}

@keyframes pulse {
    0% {
        transform: scale(1); /* Početna veličina */
    }
    50% {
        transform: scale(1.05); /* Blago povećanje veličine */
    }
    100% {
        transform: scale(1); /* Vraćanje na početnu veličinu */
    }
}


  </style>



<style>
    #current-price {
        transform: translateX(130px); /* Podesi ovu vrijednost prema željenom pomjeranju */
}

@media only screen and (max-width: 768px) {
    #current-price {
        transform: translateX(40px); /* Podesi ovu vrijednost prema željenom pomjeranju */
    }
}

#user-name {
    position: relative;
}

@media only screen and (max-width: 768px) {
    #user-name {
        transform: translateX(-20px); /* Pomjeranje ulijevo, prilagodi prema potrebi */
    }
}


</style>
</body>
</html>
